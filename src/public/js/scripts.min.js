const URL="http://192.168.0.10:3333/api",util=(()=>{const e=[];let t=0;image=((n,o,r,a)=>{n.addEventListener("change",l=>{l.preventDefault(),n.closest("form").classList.add("changed");const i={large:["my-2","col-12"],medium:["my-2","col-6"],small:["my-2","col-3"]};if(!a&&!i[a])return console.log("Informe o tamanho entre (large, medium e small)");const s=o,c=[...n.files],d=n.files[0];if(n.closest(".custom-file").querySelector("label").innerHTML=c.length+" imagens","mult"===r)c.map(n=>{const r=document.createElement("div");r.classList.add("mb-2","col-sm-3"),r.innerHTML='\n                    <img class="img-thumbnail" src="">\n                    ';const a=r.querySelector("img");if(FileReader&&n){var l=new FileReader;return l.onload=function(){a.src=l.result},l.readAsDataURL(n),e.push(n),a.dataset.index=e.indexOf(n),1===e.length&&a.classList.add("active"),((e,n)=>{e.addEventListener("click",o=>{const r=e.dataset.index;return allImages=n.querySelectorAll("img"),Array.from(allImages).forEach(e=>{e.classList.remove("active")}),e.classList.add("active"),t=parseInt(r),console.log(t)})})(a,o),s.append(r)}});else{const t=document.createElement("div");t.classList.add(...i[a]),t.innerHTML='\n                <img class="img-thumbnail" src="">\n                ';const n=t.querySelector("img");if(FileReader&&d){var u=new FileReader;return u.onload=function(){n.src=u.result},u.readAsDataURL(d),e[0]=d,s.innerHTML="",s.append(t)}}})});return{image:image,images:e,request:e=>new Promise((t,n)=>{const o=document.body.dataset.token,{url:r,method:a,body:l,headers:i}=e,s={method:a||"GET",headers:{authorization:`Bearer ${o}`}};i&&(s.headers["content-type"]=i["content-type"]),i&&(s.headers.Accept=i.Accept),l&&(s.body=l),fetch(r,s).then(e=>e.json()).then(e=>e.error?n(e.error):t(e)).catch(e=>n(e))}),scroll:e=>{e.addEventListener("click",function(e){e.preventDefault(),document.querySelector(this.getAttribute("href")).scrollIntoView({behavior:"smooth",block:"start"})})},validateSlug:e=>e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/ /g,"_"),newRequest:e=>new Promise((t,n)=>{const o=document.body.dataset.token,{url:r,method:a,body:l,headers:i}=e,s={method:a||"GET",headers:{authorization:`Bearer ${o}`}};i&&(s.headers["content-type"]=i["content-type"]),l&&(s.body=l),fetch(r,s).then(e=>e.json()).then(e=>e.error?n(e.error):t(e)).catch(e=>n(e))}),serialize:e=>{const t=[...e.elements],n={};return t.map((e,t)=>{if("radio"==e.type)return e.checked?n[e.name]=e.value:void 0;e.name&&(n[e.name]=e.value)}),n},resetForm:e=>{[...e.elements].map(e=>e.value="")},notify:e=>{const{icon:t,title:n,message:o,type:r}=e;return $.notify({icon:t,title:n,message:o},{type:r,template:'\n                <div data-notify="container" class="alert alert-dismissible alert-{0} alert-notify" role="alert">\n                    <span class="alert-icon" data-notify="icon"></span>\n                    <div class="alert-text"> \n                        <span class="alert-title" data-notify="title">{1}</span>\n                        <span data-notify="message">{2}</span>\n                    </div>\n                    <button type="button" class="close" data-notify="dismiss" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                '})}}})(),allprods=document.querySelector(".nav-link.dropdown-toggle"),hoverMenu=document.querySelector(".nav-item.dropdown");if(hoverMenu&&(hoverMenu.onmouseover=(()=>{document.querySelector(".nav-item.dropdown > ul").classList.add("show")}),hoverMenu.onmouseout=(()=>{document.querySelector(".nav-item.dropdown > ul").classList.remove("show")})),allprods&&allprods.addEventListener("click",function(e){e.preventDefault(),url=allprods.getAttribute("href"),window.matchMedia("(min-width:800px)").matches&&(window.location.href=url)}),document.querySelector("input.cpf"))var cpf=new Cleave("input.cpf",{delimiters:[".",".","-"],blocks:[3,3,3,2],uppercase:!0});if(document.querySelector("input.rg"))var rg=new Cleave("input.rg",{delimiters:[".",".","-"],blocks:[2,3,3,1],uppercase:!0});if(document.querySelector("input.zipCode"))var cep=new Cleave("input.zipCode",{delimiters:["-"],blocks:[5,3],uppercase:!0});if(document.querySelector("input#phone"))var phones=new Cleave("input#phone",{phone:!0,phoneRegionCode:"BR"});if(document.querySelector("input#cell"))var cell=new Cleave("input#cell",{phone:!0,phoneRegionCode:"BR"});const cleaveMoney={numeral:!0,prefix:"R$ ",numeralDecimalScale:2};if(document.querySelector(".iptu"))var iptu=new Cleave("input#iptu",cleaveMoney);if(document.querySelector(".condominium"))var condominium=new Cleave("input#condominium",cleaveMoney);if(document.querySelector(".water"))var water=new Cleave("input#water",cleaveMoney);if(document.querySelector(".energy"))var energy=new Cleave("input#energy",cleaveMoney);if(document.querySelector(".trash"))var trash=new Cleave("input#trash",cleaveMoney);if(document.querySelector(".cleaningFee"))var cleaningFee=new Cleave("input#cleaningFee",cleaveMoney);if(document.querySelector(".othersValues"))var othersValues=new Cleave("input#othersValues",cleaveMoney);const btnValidat=document.querySelector(".btnAnchor");btnValidat&&util.scroll(btnValidat),function(){"use strict";window.addEventListener("load",function(){var e=document.getElementsByClassName("needs-validation");Array.prototype.filter.call(e,function(e){e.addEventListener("submit",t=>{!1===e.checkValidity()&&(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")},!1)})},!1)}();const client=(()=>{const e=$(".dataTable").DataTable();return{create:e=>{e.addEventListener("submit",t=>{if(t.preventDefault(),e.checkValidity()){const t=util.serialize(e),n=(e.querySelector(".alert"),document.querySelector("#modal-notification"));return util.request({url:"/api/client",method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}).then(t=>{util.resetForm(e),n&&(n.querySelector(".modal-body h2").innerHTML=`Cliente ${t.name} cadastrado com sucesso!`,$(n).modal("show"))}).catch(e=>{const{error:t}=e;util.notify({icon:"alert-icon ni ni-bell-55",title:"Atenção! alguns erros foram encontrados!",message:e,type:"warning"}),console.log(e)})}})},show:e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.dataset.id,o=document.querySelector(".formEditClient"),r=o.querySelector("button"),a=$("#modalEditClient");return o.dataset.id=n,util.request({url:`/api/client/${n}`,method:"GET",headers:{"content-type":"application/json"}}).then(e=>(a.modal("show"),a.on("hidden.bs.modal",function(e){[...o.elements].map(e=>e.disabled=!0),r.type="button",r.disabled=!1,r.querySelector(".btn-inner--text").innerHTML="Editar",$(this).off("hidden.bs.modal")}),((e,t)=>{const{name:n,cpf:o,rg:r,gender:a,nationality:l,marital:i,birthDate:s,type:c,note:d,address:u,contact:m}=e;var p=new Date(s).toISOString().slice(0,10);t.elements.name.value=n,t.elements.cpf.value=o,t.elements.rg.value=r,t.elements.gender.value=a,t.elements.nationality.value=l,t.elements.marital.value=i,t.elements.birth_date.value=p,t.elements.type.value=c,t.elements.note.value=d;const{address:y,city:f,state:h,street:v,zipCode:g}=u;t.elements.address.value=y,t.elements.city.value=f,t.elements.state.value=h,t.elements.street.value=v,t.elements.zipCode.value=g;const{cell:b,email:w,other:S,phone:q}=m;t.elements.cell.value=b,t.elements.email.value=w,t.elements.other.value=S,t.elements.phone.value=q})(e,o))).catch(e=>{console.log(e)})})},destroy:t=>{t.addEventListener("click",function(n){n.preventDefault();const o=t.dataset.id;return util.request({url:`/api/client/${o}`,method:"DELETE",headers:{"content-type":"application/json"}}).then(n=>(e.row($(t.closest("tr"))).remove().draw(),Swal.fire("Excluído","Cliente excluído com sucesso!","success"))).catch(e=>(console.log(e),Swal.fire("Erro",e,"error")))})},edit:e=>{const t=e.querySelector("button"),n=$("#modalEditClient");t.addEventListener("click",function(o){if(o.preventDefault(),"button"!=t.type){const o=e.dataset.id,r=util.serialize(e);return util.request({url:`/api/client/${o}`,method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(r)}).then(o=>{n.modal("hide"),n.on("hidden.bs.modal",function(n){return[...e.elements].map(e=>e.disabled=!0),t.type="button",t.disabled=!1,t.querySelector(".btn-inner--text").innerHTML="Editar",$(this).off("hidden.bs.modal"),Swal.fire("Editado",`Cliente ${o.name} editado com sucesso!`,"success")})}).catch(e=>Swal.fire("Erro",e,"error"))}[...e.elements].map(e=>e.disabled=!1),t.type="submit",t.querySelector(".btn-inner--text").innerHTML="Atualizar"}),e.addEventListener("submit",function(e){e.preventDefault()})}}})(),formEditClient=document.querySelector(".formEditClient");formEditClient&&client.edit(formEditClient);const clientDestroy=document.querySelectorAll(".clientList tr .clientDestroy");clientDestroy&&Array.from(clientDestroy).forEach(e=>client.destroy(e));const clientList=document.querySelectorAll(".clientList tr .clientView");clientList&&Array.from(clientList).forEach(e=>client.show(e)),console.log("estou funcionando");const formClient=document.querySelector(".formClient");formClient&&client.create(formClient);const login={login:e=>{e.addEventListener("submit",t=>{t.preventDefault();const n=util.serialize(e);return util.request({url:"/api/login",method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(n)}).then(e=>window.location.href="/dashboard").catch(e=>console.log(e))})}},formLogin=document.querySelector(".formLogin");formLogin&&login.login(formLogin);const property={create:e=>{e.addEventListener("submit",function(t){t.preventDefault();const n=util.serialize(e);if(console.log(n),e.checkValidity())return util.request({url:"/api/property",method:"POST",headers:{Accept:"application/json","content-type":"application/json"},body:JSON.stringify(n)}).then(e=>{const{name:t}=e.property;return Swal.fire("Editado",`Imóvel ${t} cadastrado com sucesso!`,"success")}).catch(e=>{util.notify({icon:"alert-icon ni ni-bell-55",title:"Atenção! alguns erros foram encontrados!",message:e,type:"warning"})});console.log(n)})}},formInsertProperty=document.querySelector(".formInsertProperty");formInsertProperty&&property.create(formInsertProperty);